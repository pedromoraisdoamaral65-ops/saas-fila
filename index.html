<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowPro S.A. | Enterprise System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #000000;
            --card: #0a0a0a;
            --neon: #00ff88;
            --text: #ffffff;
            --subtext: #666666;
            --border: #1a1a1a;
            --danger: #ff3333;
        }

        * { box-sizing: border-box; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; overflow-x: hidden; }

        /* --- TELAS DE ACESSO --- */
        .auth-screen { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .auth-card { background: var(--card); border: 1px solid var(--border); padding: 40px; border-radius: 20px; width: 100%; max-width: 400px; text-align: center; }
        
        input { width: 100%; background: #111; border: 1px solid var(--border); padding: 15px; border-radius: 8px; color: white; margin-bottom: 12px; font-size: 14px; }
        input:focus { border-color: var(--neon); outline: none; box-shadow: 0 0 10px rgba(0,255,136,0.1); }
        
        .btn-primary { width: 100%; background: var(--neon); color: black; border: none; padding: 15px; border-radius: 8px; font-weight: 800; cursor: pointer; font-size: 14px; }
        .btn-primary:hover { transform: scale(1.02); opacity: 0.9; }
        
        .link-alt { font-size: 13px; color: var(--subtext); cursor: pointer; display: block; margin-top: 15px; }
        .link-alt strong { color: var(--neon); }

        /* --- DASHBOARD --- */
        #dashboard-page { display: none; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 20px; border-bottom: 1px solid var(--border); margin-bottom: 30px; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid var(--border); }
        .stat-card h4 { font-size: 12px; color: var(--subtext); margin: 0; text-transform: uppercase; }
        .stat-card .val { font-size: 32px; font-weight: 800; color: var(--neon); margin-top: 10px; }

        /* FILA DINÂMICA */
        .queue-container { background: var(--card); padding: 25px; border-radius: 15px; border: 1px solid var(--border); }
        .queue-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #050505; border: 1px solid #1a1a1a; border-radius: 10px; margin-bottom: 10px; }
        .queue-info { display: flex; flex-direction: column; }
        .queue-info b { font-size: 16px; color: var(--text); }
        .queue-info small { color: var(--subtext); }

        .btn-group { display: flex; gap: 8px; }
        .btn-action { padding: 8px 15px; border-radius: 6px; font-size: 11px; font-weight: bold; cursor: pointer; border: none; }
        .btn-done { background: var(--neon); color: black; }
        .btn-del { background: none; border: 1px solid var(--danger); color: var(--danger); }

        /* MODAL SESSÃO */
        #session-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; }
    </style>
</head>
<body>

    <div id="session-modal">
        <div class="auth-card" style="border-color: var(--neon);">
            <h2 style="color: var(--neon);">Sessão Expirada</h2>
            <p style="color: var(--subtext);">Por segurança, faça login novamente.</p>
            <button class="btn-primary" onclick="location.reload()">RELOGAR</button>
        </div>
    </div>

    <div id="login-screen" class="auth-screen">
        <div class="auth-card">
            <div style="color: var(--neon); font-weight: 800; font-size: 26px; margin-bottom: 5px;">FLOWPRO <span style="color:white">S.A.</span></div>
            <p style="color: var(--subtext); font-size: 14px; margin-bottom: 30px;">Gestão de Elite para Barbearias</p>
            <input type="email" id="l-email" placeholder="E-mail corporativo">
            <input type="password" id="l-pass" placeholder="Sua senha">
            <button class="btn-primary" onclick="handleLogin()">ENTRAR NO PAINEL</button>
            <span class="link-alt" onclick="switchScreen('signup-screen')">Não tem conta? <strong>Cadastre-se</strong></span>
        </div>
    </div>

    <div id="signup-screen" class="auth-screen" style="display: none;">
        <div class="auth-card">
            <h2 style="margin-top:0">Novo Registro</h2>
            <input type="text" id="s-name" placeholder="Nome da Empresa">
            <input type="email" id="s-email" placeholder="E-mail de Acesso">
            <input type="password" id="s-pass" placeholder="Criar Senha Forte">
            <button class="btn-primary" onclick="handleSignup()">CRIAR MINHA CONTA</button>
            <span class="link-alt" onclick="switchScreen('login-screen')">Já possui conta? <strong>Fazer Login</strong></span>
        </div>
    </div>

    <div id="dashboard-page">
        <header class="header">
            <div>
                <div style="font-weight: 800; color: var(--neon); font-size: 18px;">DASHBOARD</div>
                <small id="timer-display" style="color: var(--subtext);"></small>
            </div>
            <button class="btn-del" style="padding: 10px 20px;" onclick="location.reload()">SAIR</button>
        </header>

        <div class="stats-grid">
            <div class="stat-card"><h4>Lucro Semanal</h4><div class="val" id="dash-semana">R$ 0</div></div>
            <div class="stat-card"><h4>Lucro Mensal</h4><div class="val" id="dash-mes">R$ 0</div></div>
            <div class="stat-card"><h4>Projeção Anual</h4><div class="val" id="dash-ano" style="color: white;">R$ 0</div></div>
        </div>

        <div class="queue-container">
            <h3 style="margin-top:0; font-size: 18px; color: var(--neon);">➕ Gerenciar Fila</h3>
            <div style="display: flex; gap: 10px; margin-bottom: 30px;">
                <input type="text" id="q-nome" placeholder="Nome do Cliente" style="margin:0">
                <input type="number" id="q-valor" placeholder="Valor (R$)" style="margin:0; width: 150px;">
                <button class="btn-primary" style="width: 150px;" onclick="addFila()">ADICIONAR</button>
            </div>

            <div id="fila-lista">
                </div>
        </div>
    </div>

    <script>
        // --- BANCO DE DADOS LOCAL (FUNCIONAL 100%) ---
        let db = JSON.parse(localStorage.getItem('flowpro_db')) || { users: [], lucroTotal: 0, fila: [] };

        function save() { localStorage.setItem('flowpro_db', JSON.stringify(db)); }

        function switchScreen(id) {
            document.querySelectorAll('.auth-screen, #dashboard-page').forEach(s => s.style.display = 'none');
            document.getElementById(id).style.display = id === 'dashboard-page' ? 'block' : 'flex';
        }

        function handleSignup() {
            const name = document.getElementById('s-name').value;
            const email = document.getElementById('s-email').value;
            const pass = document.getElementById('s-pass').value;

            if(!name || !email || !pass) return alert("Preencha todos os campos!");
            
            db.users.push({ name, email, pass });
            save();
            alert("Conta FlowPro criada com sucesso! Faça login.");
            switchScreen('login-screen');
        }

        function handleLogin() {
            const email = document.getElementById('l-email').value;
            const pass = document.getElementById('l-pass').value;
            const user = db.users.find(u => u.email === email && u.pass === pass);

            if(user) {
                switchScreen('dashboard-page');
                updateDash();
                renderFila();
                startTimer();
            } else {
                alert("Credenciais inválidas ou conta inexistente.");
            }
        }

        function addFila() {
            const nome = document.getElementById('q-nome').value;
            const valor = parseFloat(document.getElementById('q-valor').value);

            if(!nome || !valor) return alert("Insira o nome e o valor do serviço!");

            db.fila.push({ id: Date.now(), nome, valor });
            save();
            renderFila();
            document.getElementById('q-nome').value = '';
            document.getElementById('q-valor').value = '';
        }

        function renderFila() {
            const lista = document.getElementById('fila-lista');
            lista.innerHTML = db.fila.length === 0 ? '<p style="color:var(--subtext)">Nenhum cliente na fila.</p>' : '';
            
            db.fila.forEach(item => {
                lista.innerHTML += `
                    <div class="queue-item">
                        <div class="queue-info"><b>${item.nome}</b><small>Serviço: R$ ${item.valor.toFixed(2)}</small></div>
                        <div class="btn-group">
                            <button class="btn-action btn-done" onclick="concluir(${item.id})">CONCLUIR</button>
                            <button class="btn-action btn-del" onclick="cancelar(${item.id})">CANCELAR</button>
                        </div>
                    </div>
                `;
            });
        }

        function concluir(id) {
            const item = db.fila.find(f => f.id === id);
            db.lucroTotal += item.valor;
            db.fila = db.fila.filter(f => f.id !== id);
            save();
            renderFila();
            updateDash();
            if (Notification.permission === "granted") new Notification("FlowPro", { body: `Venda concluída: R$ ${item.valor}` });
        }

        function cancelar(id) {
            if(confirm("Deseja remover este cliente da fila?")) {
                db.fila = db.fila.filter(f => f.id !== id);
                save();
                renderFila();
            }
        }

        function updateDash() {
            document.getElementById('dash-semana').innerText = `R$ ${(db.lucroTotal * 0.25).toFixed(2)}`;
            document.getElementById('dash-mes').innerText = `R$ ${db.lucroTotal.toFixed(2)}`;
            document.getElementById('dash-ano').innerText = `R$ ${(db.lucroTotal * 12).toFixed(2)}`;
        }

        function startTimer() {
            let t = 300;
            const timer = setInterval(() => {
                let m = Math.floor(t/60); let s = t%60;
                document.getElementById('timer-display').innerText = `Sessão: ${m}:${s<10?'0'+s:s}`;
                if(t <= 0) { clearInterval(timer); document.getElementById('session-modal').style.display='flex'; }
                t--;
            }, 1000);
        }

        window.onload = () => { Notification.requestPermission(); };
    </script>
</body>
</html>
